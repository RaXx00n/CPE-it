

______________________________.__  __   
\_   ___ \______   \_   _____/|__|/  |_ 
/    \  \/|     ___/|    __)_ |  \   __\
\     \___|    |    |        \|  ||  |  
 \______  /____|   /_______  /|__||__|  
        \/                 \/           
CPEit - Common Platform Enumeration Inventory Tools - 2023 CSI Project


CPEit consists of two components under development:

  *An Agent containing scripts that gather information on the software installed on a machine from multiple system sourcs,
  makes an educated guess on potential CPEs, and prepares them for ingestion into Elastic.
  
  *An ELK stack configured for taking the JSON data generated by the Agent and fuzzy string-matching NIST's Official CPE Dictionary for it,
  allowing an administrator to quickly build an inventory of CPEs for all installed software on their environment, and keep it up to date automatically
  by setting the Agent to run on intervals and Elastic to generate alerts.
  
  
INSTALL AND CONFIGURE THE ELK STACK

  INSTALL ELASTICSEARCH

>apt-get install elasticsearch

Test running elasticsearch by navigating to the installation path (the example of /usr/share/elasticsearch/ will be used in this README) 
and run 
>./bin/elasticsearch

If you get errors for missing config files, the default elasticsearch.yml and log4j2.properties files can be found in the Elasticsearch repo here: [repo]
and placed at: 
/usr/share/elasticsearch/log4j2.properties
/usr/share/elasticsearch/elasticsearch.yml

You may need to configure elasticsearch.yml with the @path.data@ and @path.logs@ variables. 
/usr/share/elasticsearch/data and /var/log/elasticsearch/ can be used.

Verify Elasticsearch is running by navigating to http://localhost:9200 in your web browser. You should see a JSON response that contains basic information about your installation.




   INSTALL LOGSTASH

<code>apt-get install logstash</code>

Test runnng logstash from the installation directory (by default /usr/share/logstash/) with the command:

<code>./bin/logstash -f /usr/share/logstash/logstash.conf --path.settings /etc/logstash</code>

If you encounter permissions errors you may need to open permissons with the following commands:

<code>chmod -R 777 /var/log/logstash
 chmod -R 777 /var/lib/logstash</code>



   INSTALL KIBANA

<code>apt-get install kibana</code>

Test running Kibana from the installation directory (by default /usr/share/kibana) with the command:
<code>./bin/kibana</code>

If you encounter permissions errors you may need to open permissions with the following command:

<code> chmod -R 777 /usr/share/kibana/</code>

If you are missing Kibana.yml, it can be found at the Kibana repository here: [repo]
and placed at:
<code>/usr/share/kibana/config/kibana.yml</code> (you may need to create this directory)

With all three components of the ELK stack running, you should be able to go to 127.0.0.1:5601 on your browser and see the Dashboard. Click on Analytics > Discover and verify that your data has been ingested from the JSON file.



   EXPERIMENTAL STEP

      ADD FINGERPRINT PLUGIN TO LOGSTASH

Navigate to /usr/share/logstash/ and run:

<code>./bin/logstash-plugin install logstash-filter-fingerprint</code>

If you get an error about not being able to write to Gemfile you will need to open permissions with:

<code> chmod 777 Gemfile
chmod 777 Gemfile.lock </code>


                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
               
                                                                                                
                                                                                                
                                                                                                
